globals:
    headers:
        "*":
            - name: Authorization
              value: Auth header that was created by you when configuring this server. Servers should only have one application talking to them at a time, though this may be from a number of nodes with different auth headers
              required: true

    path arguments:
        "GET":
            - name: id
              value: UUIDv4 of the object being queried
              required: true

        "DELETE":
            - name: id
              value: UUIDv4 of the object being queried
              required: true

        "PUT":
            - name: id
              value: UUIDv4 of the object being queried
              required: true


vars:
    response:
        upload:
            title: File uploaded
            description: The file sent to the server was recieved and stored, and a token was dispatched to the requester
            body:
                lang: JSON
                content: {"id": "UUIDv4 that points to this file"}

        file:
            title: Requested file
            description: The binary of the requested file

        delete:
            title: File deleted
            description: The queried file was destroyed on the server

        md5:
            title: Content md5
            description: The md5 digest of the queried file
            body:
                lang: JSON
                content: {"md5": "md5 of this file"}

routes:
    /:
        POST:
            description: Upload some file. POST body should be multipart data containing the mime data to upload
            responses:
                200: $response.upload

    /:id/:
        GET:
            description: Get some stored file by its id
            query strings:
                - name: cropx
                  value: Pixel crop on both ends of the x axis
                  type: int
                  default: 0

                - name: cropy
                  value: Pixel crop on both ends of the y axis
                  type: int
                  default: 0

                - name: scale
                  value: Image scale percent. Thumbnails use 30(?)
                  type: int > 0
                  default: 100

                - name: scalex
                  value: Pixel scale on x axis
                  type: int

                - name: scaley
                  value: Pixel scale on y axis
                  type: int

            responses:
                200: $response.file

        DELETE:
            description: Delete some stored file by its id
            responses:
                204: $response.delete

    /:id/md5:
        GET:
            description: Get the md5 hash of some file by its id
            responses:
                200: $response.md5

    /:id/thumb:
        GET:
            description: Get the thumbnail of this image. This is a 512x512 version of this image
            responses:
                200: $response.file
